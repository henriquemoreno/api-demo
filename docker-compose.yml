services:
  apidemo-blue:
    image: ghcr.io/henriquemoreno/apidemo:${IMAGE_TAG:-latest}
    environment:
      - APP_SLOT=blue
      - APP_VERSION=${IMAGE_TAG:-latest}

  apidemo-green:
    image: ghcr.io/henriquemoreno/apidemo:${IMAGE_TAG:-latest}
    environment:
      - APP_SLOT=green
      - APP_VERSION=${IMAGE_TAG:-latest}

nginx:
  image: nginx:alpine
  environment:
    ACTIVE_SLOT: ${ACTIVE_SLOT}
    CANARY_SLOT: ${CANARY_SLOT}
    CANARY_PERCENT: ${CANARY_PERCENT}

